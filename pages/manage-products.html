<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MP Fitness - Gerenciamento de Produtos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="../css/manage-produtos.css">
</head>

<body>
    <header class="mp-header">
        <div class="mp-header-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">
                    <img src="../img/LogoMpFitnessStore.png" alt="Logo MP Fitness" style="height: 70px;">
                </div>
                <div class="logo-text">MP<span>Fitness</span></div>
            </a>

            <button class="mobile-menu-btn" id="mobile-menu-toggle" aria-label="Menu" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>

            <nav class="nav-container" id="main-nav">
                <div class="nav-links">
                    <a href="../index.html" class="nav-link"><i class="fas fa-home"></i> Início</a>
                    <a href="./acompanharPedido.html" class="nav-link"><i class="fas fa-truck"></i> Entregas</a>
                    <a href="https://wa.me/553788493019?text=Ol%C3%A1,%20quero%20entrar%20em%20contato" class="nav-link"><i class="fas fa-envelope"></i> Contato</a>
                    <a href="./cart.html" class="nav-link cart-icon" data-count="0"><i class="fas fa-shopping-cart"></i>
                        Carrinho</a>

                    <a href="./manage-products.html" class="nav-link admin-only hidden"><i
                            class="fas fa-store"></i>Produtos</a>
                    <a href="./manage_pedidos.html" class="nav-link admin-only hidden"><i
                            class="fas fa-clipboard-list"></i>Pedidos</a>
                </div>

                <div id="user-menu" class="user-menu hidden">
                    <div class="user-avatar" id="user-avatar-btn" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="./profile.html" class="dropdown-link"><i class="fas fa-user"></i> Meu Perfil</a>
                        <a href="#" id="logout-link" class="dropdown-link"><i class="fas fa-sign-out-alt"></i> Sair</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <section class="products-management">
            <h1 class="page-title">Gerenciamento de Produtos</h1>

            <div class="add-product-container">
                <button id="addProductBtn" class="add-product-btn">
                    <i class="fas fa-plus-circle"></i> Adicionar Produto
                </button>
            </div>

            <div class="filters-container">
                <div class="status-filter">
                    <label for="statusFilter">Filtrar por Status:</label>
                    <select id="statusFilter" class="form-control">
                        <option value="TODOS">Todos</option>
                        <option value="ATIVO">Ativos</option>
                        <option value="INATIVO">Inativos</option>
                    </select>
                </div>
            </div>

            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Imagem</th>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Estoque</th>
                            <th>Tamanho</th>
                            <th>Tipo</th>
                            <th>Oferta</th>
                            <th>Status</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Produtos serão carregados dinamicamente -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <div class="modal-overlay" id="productModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Adicionar Produto</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="productId">
                    <input type="hidden" id="existingImagePath">

                    <div class="form-group">
                        <label for="productName">Nome do Produto*</label>
                        <input type="text" id="productName" class="form-control" name="productName" required
                            maxlength="150">
                    </div>

                    <div class="form-group">
                        <label for="productDescription">Descrição</label>
                        <textarea id="productDescription" name="productDescription" class="form-control"
                            maxlength="500"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="productCategory">Categoria*</label>
                        <select id="productCategory" class="form-control" name="productCategory" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="Equipamentos">Equipamentos</option>
                            <option value="Suplementos">Suplementos</option>
                            <option value="Acessórios">Acessórios</option>
                            <option value="Roupas">Roupas</option>
                            <option value="Calçados">Calçados</option>
                            <option value="Bebidas">Bebidas</option>
                            <option value="Snacks">Snacks</option>
                            <option value="Geral">Geral</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="productPrice">Preço (R$)*</label>
                            <input type="number" id="productPrice" class="form-control" name="productPrice" step="0.01"
                                min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="productQuantity">Quantidade em Estoque*</label>
                            <input type="number" id="productQuantity" class="form-control" name="productQuantity"
                                min="0" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="productSize">Tamanho/Quantidade</label>
                            <input type="text" id="productSize" class="form-control" name="productSize" maxlength="50"
                                placeholder="Ex: 500g, 1kg, 30 cápsulas, Nº 42, M, etc.">
                        </div>

                        <div class="form-group">
                            <label for="productType">Tipo do Produto*</label>
                            <select id="productType" class="form-control" name="productType" required>
                                <option value="UNICO">Único</option>
                                <option value="COMBO">Combo</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="productStatus">Status*</label>
                            <select id="productStatus" class="form-control" name="productStatus" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row" id="offerFields">
                        <div class="form-group">
                            <label for="onOffer">
                                <input type="checkbox" id="onOffer" name="onOffer"> Em Oferta?
                            </label>
                        </div>

                        <div class="form-group" id="promotionalPriceField" style="display: none;">
                            <label for="promotionalPrice">Preço Promocional (R$)</label>
                            <input type="number" id="promotionalPrice" class="form-control" name="promotionalPrice"
                                step="0.01" min="0">
                        </div>
                    </div>

                    <div class="form-group" id="comboItemsContainer" style="display: none;">
                        <label>Itens do Combo</label>
                        <div id="comboItemsList">
                        </div>
                        <button type="button" id="addComboItemBtn" class="btn-secondary">
                            <i class="fas fa-plus"></i> Adicionar Item
                        </button>
                    </div>


                    <div class="form-group">
                        <label>Imagem do Produto</label>
                        <div id="imageUpload" class="image-upload">
                            <i class="fas fa-cloud-upload-alt image-upload-icon"></i>
                            <p class="image-upload-text">Arraste e solte uma imagem ou clique para selecionar</p>
                            <img id="imagePreview" class="image-preview" style="display: none;">
                            <input type="file" id="productImage" accept="image/*"  multiple style="display: none;">
                        </div>
                    </div>

                     
                        <!-- Container para múltiplos previews -->
                    <div id="imagePreviewContainer" class="image-preview-container"></div>

                    <div class="form-actions">
                        <button type="button" id="saveProductBtn" class="btn save-btn">
                            <i class="fas fa-save"></i> Salvar
                        </button>
                        <button type="button" id="cancelBtn" class="btn cancel-btn">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="comboItemTemplate" style="display: none;">
        <div class="combo-item">
            <div class="form-row">
                <div class="form-group">
                    <label>Produto*</label>
                    <select class="combo-product-select form-control" required>
                        <option value="">Selecione um produto</option>

                    </select>
                </div>

                <div class="form-group">
                    <label>Quantidade*</label>
                    <input type="number" class="combo-quantity form-control" min="1" value="1" required>
                </div>

                <button type="button" class="remove-combo-item-btn">
                    <i class="fas fa-trash"></i> Remover
                </button>
            </div>
        </div>
    </div>


    <div class="modal-overlay" id="confirmModal">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 class="modal-title">Confirmar Exclusão</h2>
                <button class="close-modal" id="closeConfirmModal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Tem certeza que deseja excluir este produto?</p>
                <div class="form-actions">
                    <button type="button" id="confirmDeleteBtn" class="btn delete-btn">
                        <i class="fas fa-trash"></i> Excluir
                    </button>
                    <button type="button" id="cancelDeleteBtn" class="btn cancel-btn">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div id="toast" class="toast"></div>

    <footer class="footer">
        <div class="container footer-container">
            <a href="../index.html" class="footer-logo">
                <div class="footer-logo-icon"><i class="fas fa-dumbbell"></i></div>
                <div>MP Fitness Store</div>
            </a>

            <div class="footer-links">
                <a href="../index.html" class="footer-link">Início</a>
                <a href="https://wa.me/553788493019?text=Ol%C3%A1,%20quero%20entrar%20em%20contato" class="footer-link">Contato</a>
                <a href="./terms.html" class="footer-link">Termos</a>
            </div>

            <div class="footer-social">
                <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
            </div>

            <p class="footer-copyright">&copy; 2025 MP Fitness Store. Todos os direitos reservados.</p>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../js/manage-products.js"></script>
    <script src="../js/header.js"></script>
</body>

</html>